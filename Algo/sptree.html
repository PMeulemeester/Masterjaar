<!DOCTYPE html>
<!-- saved from url=(0034)http://blog.cedric.ws/c-splay-tree -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Cédric Verstraeten</title>
   <link rel="icon" type="image/png" href="http://blog.cedric.ws/favicon.ico">
   <link rel="stylesheet" type="text/css" href="./sptree_files/core.min.css">
   <script type="text/javascript" async="" src="./sptree_files/ga.js"></script><script src="./sptree_files/jquery.min.js"></script>
   <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
   <script type="text/javascript">
       var _gaq = _gaq || [];
       _gaq.push(['_setAccount', 'UA-21803329-2']);
       _gaq.push(['_trackPageview']);
     
       (function() {
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
       })();
     </script>
<script type="text/javascript" async="" src="./sptree_files/embed.js"></script></head><body>
    <article id="header">
    <div id="cedric-and-kelly"></div>
    <div class="wrapper">
        <ul class="social">
            <li class="github-icon"><a href="http://github.com/cedricve" target="_blank"></a></li>
            <li class="facebook-icon"><a href="https://www.facebook.com/cedric.verstraeten.79" target="_blank"></a></li>
            <li class="twitter-icon"><a href="http://twitter.com/cedricverst" target="_blank"></a></li>
        </ul>
        <div class="content">
            <h1><a href="http://blog.cedric.ws/">Cédric Verstraeten</a></h1>
            <p>We can't solve our problems with the same thinking we used when we created them - <span class="underline">Einstein</span>.</p>
        </div>
    </div>
</article>    <article id="body-wrapper">
        <div id="sexy-body" class="blog-individual">
            <div id="go-back"><a href="http://blog.cedric.ws/"><i class="fa fa-arrow-circle-o-left"></i>  Go back to overview</a></div>
            <div class="blog-post blog-post-individual">
                <div class="cover" style="background-image: url(&#39;http://blog.cedric.ws/uploads/post-cover/medium/FFf2gyO2AUShtqXPvi8yjkCceELOGhXOh3yM32qp.png&#39;)"></div>
                <div class="blog-post-header">
                    <h1>C++ Splay Tree </h1>
                    <span class="blog-post-info">Posted on 2014-02-15 20:12:32 by <a href="http://cedric.ws/" class="marked">Cédric Verstraeten</a></span>
                </div>
                <div class="blog-content"><div><p>A Splay tree is a binary SEARCH tree which reorganises himself by every (creation, deletion or location) operation. These reorganisations can all be bad, but it’s sure that every reorganisation will bring the selected node to root. These reorganisations are called “splaying”. Wikipedia says “A splay tree is a self-adjusting binary search tree with the additional property that recently accessed elements are quick to access again. It performs basic operations such as insertion, look-up and removal in O(log n) amortized time. For many sequences of nonrandom operations, splay trees perform better than other search trees, even when the specific pattern of the sequence is unknown. The splay tree was invented by Daniel Dominic Sleator and Robert Endre Tarjan in 1985.”</p>
<p>What the man or women who wrote this on wiki means, is that every sequence of m operations (this can be: locating, deleting and adding) takes O(m lg n). Basically every single operation from the m-operations is O(lg n) in amortized time. This doesn’t mean that every single operations is really O(lg n). It’s not guaranteed that every single operation is O(lg n), they all can be very bad.</p>
<h1 id="what-the-f-ck-is-splaying-">What the f*ck is splaying?</h1>
<p>Splaying is moving a node from his original position to the root of the tree. How the hell can we do this? Rotating. Rotating is basically spinning a node and his parent node round each other, you can do a left or right spin. Why do we need to rotate? Remember we are working with a binary SEARCH tree, this means that there is a convention between the different nodes in the tree. The left child is smaller and right child is bigger than his parent, with this technique “rotating” we will not change this convention and we can take our node 1 level closer to the root.</p>
<p>You don’t believe me? I didn’t believed it either, the first time I saw this. That’s why I will convince you with a simple example.</p>
<p><img src="./sptree_files/OuxO0v3QZoCFYBLnvErNGJeQLSBCAuazxBS1kjSg.png" alt=""></p>
<p>I hope you believe me now? Yes I thought so, when you do the inorder operation you will see, it’s exactly the same as before the rotation. What we achieved is that we moved our node 1 level up.</p>
<p>Basically we can do left and right rotations untill the node reached depth 0 and so has become the new root of the binary search tree. But this is a bad idea we can do it better with operations that make the node raise with 2 levels. These operations are called “ZigZig” and “ZigZag“, the single rotation we saw above is called a “Zig” and is only required when we are near the root (when only 1 single rotation is needed to become root).</p>
<h1 id="what-are-these-monsters-">What are these monsters?</h1>
<p>The following operations are only needed when a node has a parent and a granparent. Note that when the node only has a parent, we have to do a zig operation. In other cases when a node has a grandparent we will have to do a zigzig or a zigzag operation.</p>
<p>ZigZig? This happens when the 3 nodes: child, parent and granparent are on 1 straight line. There are 2 different cases: when the parent node is a left or right child from the grandparent node. In those cases the direction of rotating is different.</p>
<p><img src="./sptree_files/HzgAIXaQLxhliOnKmy28D8K7Q74Ps4pEPOBLwYHJ.png" alt=""></p>
<p><strong>ZigZag? </strong>This happens when the 3 nodes: child, parent and granparent are making an imaginary angle of 90°. There are 2 different cases: when the parent node is a left or right child from the grandparent node. In those cases the direction of rotating is different.</p>
<p><img src="./sptree_files/pnEo55qDLPLCRs6YStegzYFEOlv4Jo2QwA1rnaba.png" alt=""></p>
<p>These 3 operations have 1 thing in common, they al make the selected node, the new root. Now imagine we have a very large tree (depth 1500). We are looking for a node with value “759″, after searching we find this node at depth 1000. Now we have to lift the node all the way up to the root (splaying). As you can imagine we will have to do multiple zigzig’s and/or zigzag’s and maybe at the end 1 zig.</p>
<h1 id="now-let-s-program">Now let’s program</h1>
<p>We won’t build our binary search tree from scratch, we will use a defined class that has been created by one of my lecturers from the Industrial Engineering Department. You can download the package below.</p>
<p><a href="https://github.com/cedricve/algorithms-datastructures/blob/master/tree-splaytree/binsearchtree.h" target="_blank"><span class="icon fa-stack fa-lg"><i class="fa fa-square fa-stack-2x"></i><i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></p>
<p>Okay, for most of us this will be a lot of information at once. That’s why I will illustrate, how these classes work.</p>
<p><img src="./sptree_files/YSDKBbm2Bpwfd2zLs3sHkpWl7Q4SIvhfvfj5gTmZ.png" alt=""></p>
<h1 id="rotating">Rotating</h1>
<p>Ok, now we know how the binary search tree is built. We can look how the rotating works. The roteer “rotate” function requires 1 parameter, turn left or not (boolean).</p>
<pre class=" language-cpp"><code class=" language-cpp">
<span class="token keyword">template</span> 
<span class="token keyword">void</span> BinTree<span class="token operator">::</span><span class="token function">roteer<span class="token punctuation">(</span></span><span class="token keyword">bool</span> left<span class="token punctuation">)</span><span class="token punctuation">{</span>
    BinNode<span class="token operator">*</span> op<span class="token punctuation">;</span>
    BinNode<span class="token operator">*</span> neer<span class="token operator">=</span>k<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">{</span>
        op<span class="token operator">=</span>k<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span>k<span class="token punctuation">;</span>
        neer<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span>k<span class="token operator">=</span>op<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>op<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
            op<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token operator">-</span>&gt;parent<span class="token operator">=</span>neer<span class="token punctuation">;</span>
        op<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token operator">=</span>neer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        op<span class="token operator">=</span>k<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token punctuation">;</span>
        neer<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token operator">=</span>op<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span>k<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>op<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span>k<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
            op<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span>k<span class="token operator">-</span>&gt;parent<span class="token operator">=</span>neer<span class="token punctuation">;</span>
        op<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span>k<span class="token operator">=</span>neer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    k<span class="token operator">=</span>op<span class="token punctuation">;</span>
    op<span class="token operator">-</span>&gt;parent<span class="token operator">=</span>neer<span class="token operator">-</span>&gt;parent<span class="token punctuation">;</span>
    neer<span class="token operator">-</span>&gt;parent<span class="token operator">=</span>op<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code>
</pre>

<p>Note that the rotating function has to be called on a BinTree object, so the rotating works on the node to which the BinTree pointer “k” is pointing to.</p>
<p><img src="./sptree_files/ggovYowNHlK9Wu20rmLueQac2brTdrUIMepPccCR.png" alt=""></p>
<p>As you can see below, there will change 6 pointers. It can look like chaos but just look at the original state, which is drawn with pencil. The first thing what happens is the creation of 2 pointers: op and neer. The pointer neer is pointing to the same BinNode as k does. Remember k is the pointer inside a BinTree on which we call the rotate method.</p>
<p>Next we check if we need to rotate to the left or right. In this case we will rotate to the right so we come in the else statement. There we assign the op pointer to the left BinNode.</p>
<p>Now as I said before when we rotate (right) a node with his parent, the right child of the node becomes the left child/node from his parent else we got 3 children and that’s not possible. We also need to change the parent pointer of the right child (if this right child exists).</p>
<p>The node has to become the new parentNode, so his right child will be his parentNode. And the “parent” from the parentNode has to become the node that has become the new parentNode.</p>
<p><img src="./sptree_files/55bXKP4xoiWG2TsVwjrRBUzNXuVa9uDcEkPPOmXY.png" alt=""></p>
<p>This is how the rotating works,  however you don’t need to know how it works exactly. You just have to trust me that it works. Just keep in mind, that when we want to rotate a node to the left/right we need the tree which has a pointer that’s pointing to it.</p>
<h1 id="creating-the-splay-class">Creating the splay class</h1>
<p>We will create a new header file splaytree.h which inherits the BinSearchTree class.</p>
<pre class=" language-cpp"><code class=" language-cpp">
<a class="token property" href="http://docs.webplatform.org/#ifndef __SPLAYTREE" target="_blank">#ifndef __SPLAYTREE</a>
<a class="token property" href="http://docs.webplatform.org/#define __SPLAYTREE" target="_blank">#define __SPLAYTREE</a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a><span class="token string">"binsearchtree.h"</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>ostream<span class="token punctuation">;</span>


<span class="token keyword">template</span> 
<span class="token keyword">class</span> <span class="token class-name">SplayTree</span> <span class="token operator">:</span> <span class="token keyword">public</span> BinSearchTree <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

#endif
</code>
</pre>

<p>Next we will override the voegtoe function and add the splay operation. Everytime we add an element to the tree, we will splay it to the root.</p>
<pre class=" language-cpp"><code class=" language-cpp">
<a class="token property" href="http://docs.webplatform.org/#ifndef __SPLAYTREE" target="_blank">#ifndef __SPLAYTREE</a>
<a class="token property" href="http://docs.webplatform.org/#define __SPLAYTREE" target="_blank">#define __SPLAYTREE</a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a><span class="token string">"binsearchtree.h"</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>ostream<span class="token punctuation">;</span>


<span class="token keyword">template</span> 
<span class="token keyword">class</span> <span class="token class-name">SplayTree</span> <span class="token operator">:</span> <span class="token keyword">public</span> BinSearchTree <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>

   <span class="token comment" spellcheck="true"> // splay operation
</span>    <span class="token keyword">void</span> <span class="token function">splay<span class="token punctuation">(</span></span>BinTree<span class="token operator">*</span><span class="token operator">&amp;</span> position<span class="token punctuation">,</span> 
BinNode<span class="token operator">*</span><span class="token operator">&amp;</span> parent<span class="token punctuation">,</span> 
BinTree<span class="token operator">*</span><span class="token operator">&amp;</span> deBinTree<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">voegtoe<span class="token punctuation">(</span></span><span class="token keyword">const</span> Sleutel<span class="token operator">&amp;</span> sl<span class="token punctuation">,</span><span class="token keyword">const</span> Data<span class="token operator">&amp;</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        BinTree<span class="token operator">*</span> position<span class="token punctuation">;</span>
        BinNode<span class="token operator">*</span> parent<span class="token punctuation">;</span>
        <span class="token function">searchPosition<span class="token punctuation">(</span></span>sl<span class="token punctuation">,</span>position<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>position<span class="token operator">-</span>&gt;k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            position<span class="token operator">-</span>&gt;k<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BinNode</span><span class="token punctuation">(</span>sl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            position<span class="token operator">-</span>&gt;k<span class="token operator">-</span>&gt;parent<span class="token operator">=</span>parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        BinTree<span class="token operator">*</span> deBinTree <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span>&gt;deBinTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">splay<span class="token punctuation">(</span></span>position<span class="token punctuation">,</span>parent<span class="token punctuation">,</span>deBinTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
#endif
</code>
</pre>

<p>We pass an extra parameter a pointer to the BinTree deBinTree. This is a pointer which is pointing to the beginning of the tree. We will need this to rotate the root and his child (zig operation).</p>
<p>We will need to check if a node is left/right from his parent. That’s why we will create a function isLeftChild().</p>
<pre class=" language-cpp"><code class=" language-cpp"><span class="token comment" spellcheck="true">
// check if position is left child from parent or not
</span><span class="token keyword">bool</span> <span class="token function">isLeftChild<span class="token punctuation">(</span></span>BinNode<span class="token operator">*</span><span class="token operator">&amp;</span> position<span class="token punctuation">,</span> BinNode<span class="token operator">*</span><span class="token operator">&amp;</span> parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>position <span class="token operator">==</span> parent<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code>
</pre>

<p>Next we can create the splay operation:</p>
<pre class=" language-cpp"><code class=" language-cpp"><span class="token comment" spellcheck="true">
// splay operation
</span><span class="token keyword">void</span> <span class="token function">splay<span class="token punctuation">(</span></span>BinTree<span class="token operator">*</span><span class="token operator">&amp;</span> position<span class="token punctuation">,</span> 
BinNode<span class="token operator">*</span><span class="token operator">&amp;</span> parent<span class="token punctuation">,</span> 
BinTree<span class="token operator">*</span><span class="token operator">&amp;</span> deBinTree<span class="token punctuation">)</span><span class="token punctuation">{</span>

   <span class="token comment" spellcheck="true"> // Not @ root 
</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>parent<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
       <span class="token comment" spellcheck="true"> //Main 1: rotate root
</span>       <span class="token comment" spellcheck="true"> // 
</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token operator">-</span>&gt;parent<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
           <span class="token comment" spellcheck="true"> // Symmetrie left child from root
</span>           <span class="token comment" spellcheck="true"> // Zig
</span>            deBinTree<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token operator">!</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>position<span class="token operator">-</span>&gt;k<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

       <span class="token comment" spellcheck="true"> //Main 2: rotate intern
</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>

            BinNode <span class="token operator">*</span> grandparentcpy <span class="token operator">=</span> parent<span class="token operator">-</span>&gt;parent<span class="token operator">-</span>&gt;parent<span class="token punctuation">;</span>
            BinTree <span class="token operator">*</span> grootparent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>grandparentcpy<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
                grootparent <span class="token operator">=</span> deBinTree<span class="token punctuation">;</span>
            <span class="token keyword">else</span><span class="token punctuation">{</span>    
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>parent<span class="token operator">-</span>&gt;parent<span class="token punctuation">,</span>grandparentcpy<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    grootparent <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>grandparentcpy<span class="token operator">-</span>&gt;left<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span>
                    grootparent <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>grandparentcpy<span class="token operator">-</span>&gt;right<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

           <span class="token comment" spellcheck="true"> // Symmetrie Parent left child from grandparent
</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>parent<span class="token punctuation">,</span>parent<span class="token operator">-</span>&gt;parent<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
               <span class="token comment" spellcheck="true"> //
</span>               <span class="token comment" spellcheck="true"> // Main 2A: if left child from parent
</span>               <span class="token comment" spellcheck="true"> // ZigZig
</span>               <span class="token comment" spellcheck="true"> //
</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>position<span class="token operator">-</span>&gt;k<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    
                    grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
               <span class="token comment" spellcheck="true"> //
</span>               <span class="token comment" spellcheck="true"> // Main 2B: if right child from parent
</span>               <span class="token comment" spellcheck="true"> // ZigZag
</span>               <span class="token comment" spellcheck="true"> //
</span>                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    parent<span class="token operator">-</span>&gt;parent<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span><span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
                    grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>


           <span class="token comment" spellcheck="true"> // Symmetrie Parent right child from grandparent
</span>            <span class="token keyword">else</span> <span class="token punctuation">{</span>
               <span class="token comment" spellcheck="true"> //
</span>               <span class="token comment" spellcheck="true"> // Main 2A: if left child from parent
</span>               <span class="token comment" spellcheck="true"> // ZigZag
</span>               <span class="token comment" spellcheck="true"> //
</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>position<span class="token operator">-</span>&gt;k<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    parent<span class="token operator">-</span>&gt;parent<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span><span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
               <span class="token comment" spellcheck="true"> //
</span>               <span class="token comment" spellcheck="true"> // Main 2B: if right child from parent
</span>               <span class="token comment" spellcheck="true"> // ZigZig
</span>               <span class="token comment" spellcheck="true"> //
</span>                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

           <span class="token comment" spellcheck="true"> // replace for while
</span>            position <span class="token operator">=</span> grootparent<span class="token punctuation">;</span>    
            parent <span class="token operator">=</span> grootparent<span class="token operator">-</span>&gt;k<span class="token operator">-</span>&gt;parent
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code>
</pre>

<p>1) First we will check if the parent is not null, because when the parent is null we know the node is at root. So we don’t need to anything.</p>
<p>2) When the parent his parent is null, we know that we have to do a zig operation. So we need to rotate the node to which deBinTree his pointer “k” is pointing.</p>
<p>3) Else we will need to do a zigzag or a zigzig.</p>
<h1 id="complete-splaytree-class">Complete splaytree class</h1>
<pre data-src="https://github.com/cedricve/algorithms-datastructures/blob/master/tree-splaytree/splaytree.h" class="  language-h"><code class="  language-h"><a class="token property" href="http://docs.webplatform.org/#ifndef __SPLAYTREE" target="_blank">#ifndef __SPLAYTREE</a>
<a class="token property" href="http://docs.webplatform.org/#define __SPLAYTREE" target="_blank">#define __SPLAYTREE</a>
<span class="token property">#include <a class="token property" href="http://docs.webplatform.org/%3Ccstdlib%3E" target="_blank">&lt;cstdlib&gt;</a></span>
<span class="token property">#include <a class="token property" href="http://docs.webplatform.org/%3Ciostream%3E" target="_blank">&lt;iostream&gt;</a></span>
<span class="token property">#include <a class="token property" href="http://docs.webplatform.org/%3Cqueue%3E" target="_blank">&lt;queue&gt;</a></span>
<a class="token property" href="http://docs.webplatform.org/#include" target="_blank">#include </a><span class="token string">"binsearchtree.h"</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>ostream<span class="token punctuation">;</span>


<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Sleutel</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">Data</span>&gt;
<span class="token keyword">class</span> <span class="token class-name">SplayTree</span> <span class="token operator">:</span> <span class="token keyword">public</span> BinSearchTree<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt; <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	
<span class="token comment" spellcheck="true">	// check if position is left child from parent or not
</span>	<span class="token keyword">bool</span> <span class="token function">isLeftChild<span class="token punctuation">(</span></span>BinNode<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span><span class="token operator">&amp;</span> position<span class="token punctuation">,</span> BinNode<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span><span class="token operator">&amp;</span> parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>position <span class="token operator">==</span> parent<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
<span class="token comment" spellcheck="true">	// splay operation
</span>	<span class="token keyword">void</span> <span class="token function">splay<span class="token punctuation">(</span></span>BinTree<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span><span class="token operator">&amp;</span> position<span class="token punctuation">,</span> BinNode<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span><span class="token operator">&amp;</span> parent<span class="token punctuation">,</span> BinTree<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span><span class="token operator">&amp;</span> deBinTree<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">	// Not @ root 
</span>		<span class="token keyword">while</span><span class="token punctuation">(</span>parent<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">	//Main 1: rotate root
</span>		<span class="token comment" spellcheck="true">	// 
</span>			<span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token operator">-</span>&gt;parent<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
			<span class="token comment" spellcheck="true">	// Symmetrie left child from root
</span>			<span class="token comment" spellcheck="true">	// Zig
</span>				deBinTree<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token operator">!</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>position<span class="token operator">-</span>&gt;k<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token comment" spellcheck="true">	//Main 2: rotate intern
</span>			<span class="token keyword">else</span> <span class="token punctuation">{</span>
				
				BinNode<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt; <span class="token operator">*</span> grandparentcpy <span class="token operator">=</span> parent<span class="token operator">-</span>&gt;parent<span class="token operator">-</span>&gt;parent<span class="token punctuation">;</span>
				BinTree<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt; <span class="token operator">*</span> grootparent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				
				<span class="token keyword">if</span><span class="token punctuation">(</span>grandparentcpy<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
					grootparent <span class="token operator">=</span> deBinTree<span class="token punctuation">;</span>
				<span class="token keyword">else</span><span class="token punctuation">{</span>	
					<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>parent<span class="token operator">-</span>&gt;parent<span class="token punctuation">,</span>grandparentcpy<span class="token punctuation">)</span><span class="token punctuation">)</span>
						grootparent <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>grandparentcpy<span class="token operator">-</span>&gt;left<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">else</span>
						grootparent <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>grandparentcpy<span class="token operator">-</span>&gt;right<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				
			<span class="token comment" spellcheck="true">	// Symmetrie Parent left child from grandparent
</span>				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>parent<span class="token punctuation">,</span>parent<span class="token operator">-</span>&gt;parent<span class="token punctuation">)</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
				<span class="token comment" spellcheck="true">	//
</span>				<span class="token comment" spellcheck="true">	// Main 2A: if left child from parent
</span>				<span class="token comment" spellcheck="true">	// ZigZig
</span>				<span class="token comment" spellcheck="true">	//
</span>					<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>position<span class="token operator">-</span>&gt;k<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>	
					<span class="token comment" spellcheck="true">	// if mag weg als deBinTree probleem opgelost
</span>						grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token comment" spellcheck="true">	//
</span>				<span class="token comment" spellcheck="true">	// Main 2B: if right child from parent
</span>				<span class="token comment" spellcheck="true">	// ZigZag
</span>				<span class="token comment" spellcheck="true">	//
</span>					<span class="token keyword">else</span> <span class="token punctuation">{</span>
						parent<span class="token operator">-</span>&gt;parent<span class="token operator">-</span>&gt;left<span class="token punctuation">.</span><span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
						grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				
				
			<span class="token comment" spellcheck="true">	// Symmetrie Parent right child from grandparent
</span>				<span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token comment" spellcheck="true">	//
</span>				<span class="token comment" spellcheck="true">	// Main 2A: if left child from parent
</span>				<span class="token comment" spellcheck="true">	// ZigZag
</span>				<span class="token comment" spellcheck="true">	//
</span>					<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLeftChild<span class="token punctuation">(</span></span>position<span class="token operator">-</span>&gt;k<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						parent<span class="token operator">-</span>&gt;parent<span class="token operator">-</span>&gt;right<span class="token punctuation">.</span><span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token comment" spellcheck="true">	//
</span>				<span class="token comment" spellcheck="true">	// Main 2B: if right child from parent
</span>				<span class="token comment" spellcheck="true">	// ZigZig
</span>				<span class="token comment" spellcheck="true">	//
</span>					<span class="token keyword">else</span> <span class="token punctuation">{</span>
						grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						grootparent<span class="token operator">-</span>&gt;<span class="token function">roteer<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				
			<span class="token comment" spellcheck="true">	// replace for while
</span>				position <span class="token operator">=</span> grootparent<span class="token punctuation">;</span>	
				parent <span class="token operator">=</span> grootparent<span class="token operator">-</span>&gt;k<span class="token operator">-</span>&gt;parent<span class="token punctuation">;</span>

			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">voegtoe<span class="token punctuation">(</span></span><span class="token keyword">const</span> Sleutel<span class="token operator">&amp;</span> sl<span class="token punctuation">,</span><span class="token keyword">const</span> Data<span class="token operator">&amp;</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    BinTree<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span> position<span class="token punctuation">;</span>
	    BinNode<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span> parent<span class="token punctuation">;</span>
	    <span class="token function">searchPosition<span class="token punctuation">(</span></span>sl<span class="token punctuation">,</span>position<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token keyword">if</span> <span class="token punctuation">(</span>position<span class="token operator">-</span>&gt;k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	        position<span class="token operator">-</span>&gt;k<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BinNode</span><span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token punctuation">(</span>sl<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	        position<span class="token operator">-</span>&gt;k<span class="token operator">-</span>&gt;parent<span class="token operator">=</span>parent<span class="token punctuation">;</span>
	    <span class="token punctuation">}</span>
		BinTree<span class="token operator">&lt;</span>Sleutel<span class="token punctuation">,</span>Data&gt;<span class="token operator">*</span> deBinTree <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span>&gt;deBinTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">splay<span class="token punctuation">(</span></span>position<span class="token punctuation">,</span>parent<span class="token punctuation">,</span>deBinTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

#endif


</code></pre>

<h1 id="download">Download</h1>
<p>You can download the complete package below.</p>
<p><a href="https://github.com/cedricve/algorithms-datastructures/tree/master/tree-splaytree" target="_blank"><span class="icon fa-stack fa-lg"><i class="fa fa-square fa-stack-2x"></i><i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></p>
</div></div>
            </div>
            <div id="go-back" class="go-back-bottom"><a href="http://blog.cedric.ws/"><i class="fa fa-arrow-circle-o-left"></i>  Go back to overview</a></div>
            <div id="about-me">
    <a href="http://cedric.ws/">
        <span class="my-head"></span>
    </a>
    <p class="some-bullshit">
        Hey, I'm Cédric a motivated <b>M. Sc. in Engineering</b>, always ready to broaden my horizon and to discover and learn new methodologies. With a huge interest in math, physics, digital image processing, <b>artificial intelligence</b> and <b>bioinformatics</b>, I try to understand our mountainous world a little bit better. I defended my dissertation with honors for world's largest steel company, ArcelorMittal: Development of algorithms for <b>label recognition</b>. These days I'm functioning as a <b>R&amp;D Software Engineer</b> at NV Michel Van de Wiele.
    </p>
</div>            <div id="disqus-comments">
    <div id="disqus_thread"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./sptree_files/saved_resource.html" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 321px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'cedricve-blog'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>    
</div>        </div>
    </article>
    <footer>
    <ul class="social">
        <li class="github-icon"><a href="http://github.com/cedricve" target="_blank"></a></li>
        <li class="facebook-icon"><a href="https://www.facebook.com/cedric.verstraeten.79" target="_blank"></a></li>
        <li class="twitter-icon"><a href="http://twitter.com/cedricverst" target="_blank"></a></li>
    </ul>
    <p>All content copyright <a href="http://cedric.ws/">cedric.ws</a> © 2014 • All rights reserved. <br> Proudly designed and developed by <a href="http://cedric.ws/">cedric.ws</a></p>
</footer>
<script type="text/javascript">
  $("#search-post").bind('keyup',function(e){
     if(e.keyCode != 13) return; // only post when pressed enter .
     window.location.href = "/search/" + $(this).val();
  });
</script>    <script src="./sptree_files/prism.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $("p.g-ad ins").css({"width":"100%"});
            $("p.g-ad ins iframe").attr({"width":"100%"});
        });
    </script>

</body></html>